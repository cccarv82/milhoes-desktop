import './style.css';
import './app.css';

import { GenerateStrategy, TestConnections, GetNextDraws, SaveConfig, ValidateConfig, GetDefaultConfig, GetStatistics, TestConnectionsWithConfig, DebugClaudeConfig } from '../wailsjs/go/main/App';

// Tipos TypeScript para nossa aplica√ß√£o
interface UserPreferences {
    lotteryTypes: string[];
    budget: number;
    strategy: string;
    avoidPatterns: boolean;
    favoriteNumbers: number[];
    excludeNumbers: number[];
}

interface LotteryGame {
    type: string;
    numbers: number[];
    cost: number;
}

interface Strategy {
    budget: number;
    totalCost: number;
    games: LotteryGame[];
    reasoning: string;
    statistics: {
        analyzedDraws: number;
        hotNumbers: number[];
        coldNumbers: number[];
    };
}

interface StrategyResponse {
    success: boolean;
    strategy?: Strategy;
    confidence?: number;
    error?: string;
    availableLotteries?: string[];
    failedLotteries?: string[];
}

interface ConnectionStatus {
    caixaAPI: boolean;
    caixaError?: string;
    claudeAPI: boolean;
    claudeError?: string;
}

interface ConfigData {
    claudeApiKey: string;
    claudeModel: string;
    timeoutSec: number;
    maxTokens: number;
    verbose: boolean;
}

// Estado global da aplica√ß√£o
let userPreferences: UserPreferences = {
    lotteryTypes: [],
    budget: 0,
    strategy: '',
    avoidPatterns: false,
    favoriteNumbers: [],
    excludeNumbers: []
};

let currentConfig: ConfigData = {
    claudeApiKey: '',
    claudeModel: 'claude-3-5-sonnet-20241022',
    timeoutSec: 60,
    maxTokens: 8000,
    verbose: false
};

// ===============================
// INICIALIZA√á√ÉO
// ===============================

document.addEventListener('DOMContentLoaded', async () => {
    console.log('üé∞ Lottery Optimizer iniciado!');
    
    // Adicionar bot√£o de debug
    addDebugButton();
    
    // Verificar configura√ß√£o e renderizar tela apropriada
    await checkConfigAndRender();
});

// ===============================
// TELA DE CONFIGURA√á√ÉO OBRIGAT√ìRIA
// ===============================

function renderConfigurationRequired() {
    const app = document.getElementById('app')!;
    app.innerHTML = `
        <div class="container">
            <header class="header">
                <div class="header-content">
                    <h1 class="logo">üé∞ Lottery Optimizer</h1>
                    <p class="tagline">Configura√ß√£o Necess√°ria</p>
                </div>
            </header>
            
            <div class="main-content">
                <div class="error-content" style="max-width: 600px; margin: 0 auto;">
                    <div class="error-icon">‚öôÔ∏è</div>
                    <h2>Configura√ß√£o Necess√°ria</h2>
                    <p class="error-message">
                        Para usar o Lottery Optimizer, voc√™ precisa configurar sua chave da API do Claude. 
                        Isso permite que a IA analise os dados e gere estrat√©gias inteligentes.
                    </p>
                    
                    <div class="error-actions">
                        <button class="btn-primary" onclick="renderConfigurationScreen()">
                            <span class="btn-icon">üîß</span>
                            Configurar Agora
                        </button>
                    </div>
                </div>
            </div>
        </div>
    `;
}

// ===============================
// TELA DE CONFIGURA√á√ïES
// ===============================

function renderConfigurationScreen() {
    const app = document.getElementById('app')!;
    app.innerHTML = `
        <div class="container">
            <header class="header">
                <div class="header-content">
                    <h1 class="logo">üé∞ Lottery Optimizer</h1>
                    <p class="tagline">Configura√ß√µes</p>
                </div>
                <div class="header-actions">
                    <button class="btn-back" onclick="checkConfigAndRender()">
                        <span class="btn-icon">‚Üê</span>
                        Voltar
                    </button>
                </div>
            </header>
            
            <div class="wizard-content">
                <div class="wizard-steps">
                    <div class="step active">‚öôÔ∏è Configura√ß√µes</div>
                </div>

                <form class="config-form" onsubmit="handleConfigSave(event)">
                    <!-- API Claude -->
                    <div class="form-section">
                        <h3>
                            <span>ü§ñ</span>
                            Configura√ß√£o da API Claude
                        </h3>
                        <p style="color: var(--text-secondary); margin-bottom: var(--spacing-6);">
                            O Claude √© a IA que analisa os dados hist√≥ricos e gera estrat√©gias inteligentes. 
                            <a href="https://console.anthropic.com/" target="_blank" style="color: var(--accent-primary);">Obtenha sua chave aqui</a>.
                        </p>
                        
                        <div class="numbers-input">
                            <label for="claudeApiKey">Chave da API *</label>
                            <input 
                                type="password" 
                                id="claudeApiKey" 
                                name="claudeApiKey" 
                                value="${currentConfig.claudeApiKey}"
                                placeholder="sk-ant-api03-..." 
                                required
                            >
                        </div>
                        
                        <div class="numbers-input">
                            <label for="claudeModel">Modelo</label>
                            <select 
                                id="claudeModel" 
                                name="claudeModel" 
                                style="width: 100%; padding: var(--spacing-4); background: var(--bg-tertiary); border: 2px solid var(--border-color); border-radius: var(--border-radius); color: var(--text-primary); font-size: var(--font-size-base);"
                            >
                                <option value="claude-3-5-sonnet-20241022" ${currentConfig.claudeModel === 'claude-3-5-sonnet-20241022' ? 'selected' : ''}>Claude 3.5 Sonnet (Recomendado)</option>
                                <option value="claude-3-opus-20240229" ${currentConfig.claudeModel === 'claude-3-opus-20240229' ? 'selected' : ''}>Claude 3 Opus</option>
                                <option value="claude-3-haiku-20240307" ${currentConfig.claudeModel === 'claude-3-haiku-20240307' ? 'selected' : ''}>Claude 3 Haiku</option>
                            </select>
                        </div>
                    </div>

                    <!-- Configura√ß√µes Avan√ßadas -->
                    <div class="form-section">
                        <h3>
                            <span>üîß</span>
                            Configura√ß√µes Avan√ßadas
                        </h3>
                        
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: var(--spacing-4);">
                            <div class="numbers-input">
                                <label for="timeoutSec">Timeout (segundos)</label>
                                <input 
                                    type="number" 
                                    id="timeoutSec" 
                                    name="timeoutSec" 
                                    value="${currentConfig.timeoutSec}"
                                    min="10" 
                                    max="300" 
                                    required
                                >
                            </div>
                            
                            <div class="numbers-input">
                                <label for="maxTokens">M√°ximo de Tokens</label>
                                <input 
                                    type="number" 
                                    id="maxTokens" 
                                    name="maxTokens" 
                                    value="${currentConfig.maxTokens}"
                                    min="1000" 
                                    max="12000" 
                                    required
                                >
                            </div>
                        </div>
                        
                        <div class="checkbox-option">
                            <input 
                                type="checkbox" 
                                id="verbose" 
                                name="verbose" 
                                ${currentConfig.verbose ? 'checked' : ''}
                            >
                            <label for="verbose">Modo verboso (logs detalhados)</label>
                        </div>
                    </div>

                    <!-- Teste de Conex√£o -->
                    <div class="form-section">
                        <h3>
                            <span>üîó</span>
                            Teste de Conex√£o
                        </h3>
                        <p style="color: var(--text-secondary); margin-bottom: var(--spacing-4);">
                            Teste as conex√µes com as APIs antes de salvar.
                        </p>
                        
                        <div style="display: flex; gap: var(--spacing-4); margin-bottom: var(--spacing-6); flex-wrap: wrap;">
                            <button type="button" class="btn-secondary" onclick="testConnections()">
                                <span class="btn-icon">üîÑ</span>
                                Testar Conex√µes
                            </button>
                        </div>
                        
                        <div id="connectionStatus"></div>
                    </div>

                    <!-- A√ß√µes -->
                    <div class="form-actions">
                        <button type="button" class="btn-secondary" onclick="loadDefaultConfig()">
                            <span class="btn-icon">üîÑ</span>
                            Restaurar Padr√£o
                        </button>
                        <button type="submit" class="btn-primary">
                            <span class="btn-icon">üíæ</span>
                            Salvar Configura√ß√£o
                        </button>
                    </div>
                </form>
            </div>
        </div>
    `;
}

// Testar conex√µes
async function testConnections() {
    const statusDiv = document.getElementById('connectionStatus')!;
    statusDiv.innerHTML = '<div class="loading">Testando conex√µes...</div>';
    
    try {
        // Coletar dados do formul√°rio atual
        const form = document.querySelector('.config-form') as HTMLFormElement;
        const formData = new FormData(form);
        
        const testConfig: ConfigData = {
            claudeApiKey: formData.get('claudeApiKey') as string,
            claudeModel: formData.get('claudeModel') as string,
            timeoutSec: parseInt(formData.get('timeoutSec') as string),
            maxTokens: parseInt(formData.get('maxTokens') as string),
            verbose: formData.has('verbose')
        };
        
        // Usar a nova fun√ß√£o que testa com a configura√ß√£o fornecida
        const status: ConnectionStatus = await TestConnectionsWithConfig(testConfig);
        
        statusDiv.innerHTML = `
            <div class="status-grid">
                <div class="status-card ${status.caixaAPI ? 'status-ok' : 'status-error'}">
                    <div class="status-icon">${status.caixaAPI ? '‚úÖ' : '‚ùå'}</div>
                    <div class="status-content">
                        <h4>API Caixa</h4>
                        <p>${status.caixaAPI ? 'Conectado' : 'Erro'}</p>
                        ${status.caixaError ? `<small style="color: var(--accent-error);">${status.caixaError}</small>` : ''}
                    </div>
                </div>
                
                <div class="status-card ${status.claudeAPI ? 'status-ok' : 'status-error'}">
                    <div class="status-icon">${status.claudeAPI ? '‚úÖ' : '‚ùå'}</div>
                    <div class="status-content">
                        <h4>Claude API</h4>
                        <p>${status.claudeAPI ? 'Conectado' : 'Erro'}</p>
                        ${status.claudeError ? `<small style="color: var(--accent-error);">${status.claudeError}</small>` : ''}
                    </div>
                </div>
            </div>
        `;
    } catch (error) {
        statusDiv.innerHTML = `<div class="error-message">Erro ao testar conex√µes: ${error}</div>`;
    }
}

// Carregar configura√ß√£o padr√£o
async function loadDefaultConfig() {
    try {
        currentConfig = await GetDefaultConfig();
        renderConfigurationScreen();
    } catch (error) {
        console.error('Erro ao carregar configura√ß√£o padr√£o:', error);
    }
}

// Salvar configura√ß√£o
async function handleConfigSave(event: Event) {
    event.preventDefault();
    
    const form = event.target as HTMLFormElement;
    const formData = new FormData(form);
    
    const configData: ConfigData = {
        claudeApiKey: formData.get('claudeApiKey') as string,
        claudeModel: formData.get('claudeModel') as string,
        timeoutSec: parseInt(formData.get('timeoutSec') as string),
        maxTokens: parseInt(formData.get('maxTokens') as string),
        verbose: formData.has('verbose')
    };
    
    try {
        const saveButton = form.querySelector('button[type="submit"]') as HTMLButtonElement;
        saveButton.innerHTML = '<span class="btn-icon">‚è≥</span> Salvando...';
        saveButton.disabled = true;
        
        const result = await SaveConfig(configData);
        
        if (result.success) {
            currentConfig = configData;
            
            // Mostrar sucesso
            const statusDiv = document.getElementById('connectionStatus')!;
            statusDiv.innerHTML = `
                <div style="background: rgba(16, 185, 129, 0.1); border: 1px solid var(--accent-success); border-radius: var(--border-radius); padding: var(--spacing-4); color: var(--accent-success);">
                    ‚úÖ ${result.message}
                </div>
            `;
            
            // Aguardar um pouco para o backend processar a nova configura√ß√£o
            setTimeout(async () => {
                renderWelcome();
                // Recarregar status das conex√µes ap√≥s um pequeno delay
                setTimeout(() => {
                    loadConnectionStatus();
                }, 500);
            }, 1000);
        } else {
            throw new Error(result.error);
        }
    } catch (error) {
        const statusDiv = document.getElementById('connectionStatus')!;
        statusDiv.innerHTML = `
            <div style="background: rgba(239, 68, 68, 0.1); border: 1px solid var(--accent-error); border-radius: var(--border-radius); padding: var(--spacing-4); color: var(--accent-error);">
                ‚ùå Erro: ${error}
            </div>
        `;
        
        const saveButton = form.querySelector('button[type="submit"]') as HTMLButtonElement;
        saveButton.innerHTML = '<span class="btn-icon">üíæ</span> Salvar Configura√ß√£o';
        saveButton.disabled = false;
    }
}

// ===============================
// VERIFICAR CONFIGURA√á√ÉO E RENDERIZAR
// ===============================

async function checkConfigAndRender() {
    try {
        const validation = await ValidateConfig();
        
        if (!validation.claudeConfigured) {
            renderConfigurationRequired();
        } else {
            renderWelcome();
        }
    } catch (error) {
        console.error('Erro ao validar configura√ß√£o:', error);
        renderConfigurationRequired();
    }
}

// ===============================
// TELA DE BOAS-VINDAS MODERNA
// ===============================

function renderWelcome() {
    const app = document.getElementById('app')!;
    app.innerHTML = `
        <div class="container">
            <header class="header">
                <div class="header-content">
                    <h1 class="logo">üé∞ Lottery Optimizer</h1>
                    <p class="tagline">Estrat√©gias Inteligentes para Loterias</p>
                </div>
                <div class="ai-badge">
                    <span class="ai-icon">ü§ñ</span>
                    Powered by Claude AI
                </div>
            </header>
            
            <div class="main-content">
                <div class="welcome-section">
                    <h2 style="font-size: var(--font-size-4xl); font-weight: 800; margin-bottom: var(--spacing-6); background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary)); background-clip: text; -webkit-background-clip: text; -webkit-text-fill-color: transparent;">
                        Bem-vindo ao Futuro das Loterias! üöÄ
                    </h2>
                    <p style="font-size: var(--font-size-xl); color: var(--text-secondary); max-width: 600px; margin: 0 auto var(--spacing-8) auto; line-height: 1.7;">
                        Utilize o poder da intelig√™ncia artificial para gerar estrat√©gias baseadas em an√°lise hist√≥rica, 
                        padr√µes estat√≠sticos e suas prefer√™ncias pessoais.
                    </p>
                </div>
                
                <div class="features-grid">
                    <div class="feature-card">
                        <span class="feature-icon">üß†</span>
                        <h3>IA Avan√ßada</h3>
                        <p>Claude 3.5 Sonnet analisa milhares de sorteios hist√≥ricos para identificar padr√µes e tend√™ncias √∫nicas.</p>
                    </div>
                    
                    <div class="feature-card">
                        <span class="feature-icon">üìä</span>
                        <h3>An√°lise Estat√≠stica</h3>
                        <p>Algoritmos sofisticados calculam probabilidades, n√∫meros quentes e frios, al√©m de padr√µes de frequ√™ncia.</p>
                    </div>
                    
                    <div class="feature-card">
                        <span class="feature-icon">üéØ</span>
                        <h3>Estrat√©gias Personalizadas</h3>
                        <p>Configure seu or√ßamento, prefira n√∫meros da sorte e evite padr√µes para estrat√©gias totalmente customizadas.</p>
                    </div>
                    
                    <div class="feature-card">
                        <span class="feature-icon">üíé</span>
                        <h3>Multi-Loteria</h3>
                        <p>Suporte completo para Mega-Sena e Lotof√°cil com dados sempre atualizados da CAIXA.</p>
                    </div>
                    
                    <div class="feature-card">
                        <span class="feature-icon">‚ö°</span>
                        <h3>Resultados Instant√¢neos</h3>
                        <p>Gere estrat√©gias completas em segundos com explica√ß√µes detalhadas do racioc√≠nio da IA.</p>
                    </div>
                    
                    <div class="feature-card">
                        <span class="feature-icon">üîí</span>
                        <h3>100% Seguro</h3>
                        <p>Todos os c√°lculos s√£o feitos localmente. Seus dados e prefer√™ncias nunca saem do seu computador.</p>
                    </div>
                </div>
                
                <div class="cta-section">
                    <button class="btn-primary" onclick="startStrategyWizard()">
                        <span class="btn-icon">üé≤</span>
                        Gerar Estrat√©gia Inteligente
                    </button>
                    <button class="btn-secondary" onclick="renderConfigurationScreen()">
                        <span class="btn-icon">‚öôÔ∏è</span>
                        Configura√ß√µes
                    </button>
                </div>
                
                <!-- Informa√ß√µes dos pr√≥ximos sorteios -->
                <div class="next-draws-section">
                    <h3>
                        <span>üéØ</span>
                        Pr√≥ximos Sorteios
                    </h3>
                    <div class="draws-grid" id="nextDraws">
                        <div class="loading">Carregando pr√≥ximos sorteios...</div>
                    </div>
                </div>
                
                <!-- Status das conex√µes -->
                <div class="status-section">
                    <h3>
                        <span>üîó</span>
                        Status das Conex√µes
                    </h3>
                    <div class="status-grid" id="connectionStatusGrid">
                        <div class="loading">Verificando conex√µes...</div>
                    </div>
                </div>
                
                <!-- Estat√≠sticas r√°pidas -->
                <div class="statistics-section">
                    <h3>
                        <span>üìà</span>
                        Estat√≠sticas R√°pidas
                    </h3>
                    <div class="stats-grid" id="quickStats">
                        <div class="loading">Carregando estat√≠sticas...</div>
                    </div>
                </div>
            </div>
        </div>
    `;
    
    // Carregar dados ass√≠ncronos
    loadNextDraws();
    loadConnectionStatus();
    loadQuickStats();
}

// Carregar pr√≥ximos sorteios
async function loadNextDraws() {
    try {
        const nextDraws = await GetNextDraws();
        const container = document.getElementById('nextDraws');
        
        if (!container) {
            console.warn('Elemento nextDraws n√£o encontrado');
            return;
        }
        
        let html = '';
        
        if (nextDraws.megasena) {
            html += `
                <div class="draw-card">
                    <div class="draw-icon">üî•</div>
                    <div class="draw-content">
                        <h4>Mega-Sena</h4>
                        <p>Sorteio ${nextDraws.megasena.number}</p>
                        <small>${nextDraws.megasena.date}</small>
                    </div>
                </div>
            `;
        }
        
        if (nextDraws.lotofacil) {
            html += `
                <div class="draw-card">
                    <div class="draw-icon">‚≠ê</div>
                    <div class="draw-content">
                        <h4>Lotof√°cil</h4>
                        <p>Sorteio ${nextDraws.lotofacil.number}</p>
                        <small>${nextDraws.lotofacil.date}</small>
                    </div>
                </div>
            `;
        }
        
        if (html === '') {
            html = '<div class="no-data">Nenhum sorteio programado</div>';
        }
        
        container.innerHTML = html;
    } catch (error) {
        const container = document.getElementById('nextDraws');
        if (container) {
            container.innerHTML = '<div class="no-data">Erro ao carregar sorteios</div>';
        }
    }
}

// Carregar status das conex√µes
async function loadConnectionStatus() {
    try {
        const status: ConnectionStatus = await TestConnections();
        const container = document.getElementById('connectionStatusGrid')!;
        
        container.innerHTML = `
            <div class="status-card ${status.caixaAPI ? 'status-ok' : 'status-error'}">
                <div class="status-icon">${status.caixaAPI ? '‚úÖ' : '‚ùå'}</div>
                <div class="status-content">
                    <h4>API Caixa</h4>
                    <p>${status.caixaAPI ? 'Conectado' : 'Erro de conex√£o'}</p>
                </div>
            </div>
            
            <div class="status-card ${status.claudeAPI ? 'status-ok' : 'status-error'}">
                <div class="status-icon">${status.claudeAPI ? '‚úÖ' : '‚ùå'}</div>
                <div class="status-content">
                    <h4>Claude API</h4>
                    <p>${status.claudeAPI ? 'Conectado' : 'Erro de conex√£o'}</p>
                </div>
            </div>
        `;
    } catch (error) {
        document.getElementById('connectionStatusGrid')!.innerHTML = '<div class="no-data">Erro ao verificar conex√µes</div>';
    }
}

// Carregar estat√≠sticas r√°pidas
async function loadQuickStats() {
    try {
        const stats = await GetStatistics();
        const container = document.getElementById('quickStats');
        
        if (!container) {
            console.warn('Elemento quickStats n√£o encontrado');
            return;
        }
        
        let html = '';
        
        if (stats.megasena) {
            html += `
                <div class="stat-card">
                    <div class="stat-icon">üî•</div>
                    <div class="stat-content">
                        <span class="label">Mega-Sena</span>
                        <span class="value">${stats.megasena.totalDraws}</span>
                        <small>sorteios analisados</small>
                    </div>
                </div>
            `;
        }
        
        if (stats.lotofacil) {
            html += `
                <div class="stat-card">
                    <div class="stat-icon">‚≠ê</div>
                    <div class="stat-content">
                        <span class="label">Lotof√°cil</span>
                        <span class="value">${stats.lotofacil.totalDraws}</span>
                        <small>sorteios analisados</small>
                    </div>
                </div>
            `;
        }
        
        if (html === '') {
            html = '<div class="no-data">Nenhuma estat√≠stica dispon√≠vel</div>';
        }
        
        container.innerHTML = html;
    } catch (error) {
        const container = document.getElementById('quickStats');
        if (container) {
            container.innerHTML = '<div class="no-data">Erro ao carregar estat√≠sticas</div>';
        }
    }
}

// ===============================
// WIZARD DE ESTRAT√âGIA
// ===============================

// Iniciar wizard de estrat√©gia
function startStrategyWizard() {
    renderPreferencesForm();
}

// Renderizar formul√°rio de prefer√™ncias
function renderPreferencesForm() {
    const app = document.getElementById('app')!;
    app.innerHTML = `
        <div class="container">
            <header class="header">
                <div class="header-content">
                    <h1 class="logo">üé∞ Lottery Optimizer</h1>
                    <p class="tagline">Assistente de Estrat√©gia</p>
                </div>
                <button class="btn-back" onclick="renderWelcome()">
                    <span class="btn-icon">‚Üê</span>
                    Voltar
                </button>
            </header>
            
            <div class="wizard-content">
                <div class="wizard-steps">
                    <div class="step active">1. Prefer√™ncias</div>
                    <div class="step">2. Estrat√©gia</div>
                    <div class="step">3. Resultados</div>
                </div>

                <form class="preferences-form" onsubmit="handlePreferencesSubmit(event)">
                    <!-- Sele√ß√£o de Loterias -->
                    <div class="form-section">
                        <h3>
                            <span>üéØ</span>
                            Escolha suas Loterias
                        </h3>
                        <div class="lottery-options">
                            <label class="lottery-option">
                                <input type="checkbox" name="lotteryType" value="megasena">
                                <div class="option-card">
                                    <span class="option-icon">üî•</span>
                                    <div class="option-content">
                                        <h4>Mega-Sena</h4>
                                        <p>6 n√∫meros de 1 a 60</p>
                                        <small>Sorteios: Wed & Sat</small>
                                    </div>
                                </div>
                            </label>
                            
                            <label class="lottery-option">
                                <input type="checkbox" name="lotteryType" value="lotofacil">
                                <div class="option-card">
                                    <span class="option-icon">‚≠ê</span>
                                    <div class="option-content">
                                        <h4>Lotof√°cil</h4>
                                        <p>15 n√∫meros de 1 a 25</p>
                                        <small>Sorteios: Mon, Tue, Thu, Fri</small>
                                    </div>
                                </div>
                            </label>
                        </div>
                    </div>

                    <!-- Or√ßamento -->
                    <div class="form-section">
                        <h3>
                            <span>üí∞</span>
                            Defina seu Or√ßamento
                        </h3>
                        <div class="budget-input">
                            <span class="currency">R$</span>
                            <input 
                                type="number" 
                                name="budget" 
                                placeholder="100" 
                                min="5" 
                                max="10000" 
                                step="0.01" 
                                required
                            >
                        </div>
                        <div class="budget-suggestions">
                            <button type="button" class="budget-btn" onclick="setBudget(20)">R$ 20</button>
                            <button type="button" class="budget-btn" onclick="setBudget(50)">R$ 50</button>
                            <button type="button" class="budget-btn" onclick="setBudget(100)">R$ 100</button>
                            <button type="button" class="budget-btn" onclick="setBudget(200)">R$ 200</button>
                            <button type="button" class="budget-btn" onclick="setBudget(500)">R$ 500</button>
                        </div>
                    </div>

                    <!-- Estrat√©gia -->
                    <div class="form-section">
                        <h3>
                            <span>üß†</span>
                            Estrat√©gia de An√°lise
                        </h3>
                        <div class="strategy-info" style="background: var(--bg-tertiary); padding: var(--spacing-4); border-radius: var(--border-radius); margin-bottom: var(--spacing-4);">
                            <h4 style="color: var(--accent-primary); margin-bottom: var(--spacing-2);">üéØ Estrat√©gia Inteligente</h4>
                            <p style="color: var(--text-secondary); margin: 0; line-height: 1.6;">
                                Nossa IA analisa milhares de sorteios hist√≥ricos, identifica padr√µes estat√≠sticos, 
                                n√∫meros quentes e frios, e gera combina√ß√µes otimizadas para maximizar suas chances de ganhar.
                            </p>
                        </div>
                        
                        <div class="strategy-options">
                            <label class="strategy-option">
                                <input type="radio" name="strategy" value="intelligent" checked style="display: none;">
                                <div class="option-card" style="border: 2px solid var(--accent-primary); background: rgba(99, 102, 241, 0.1);">
                                    <span class="option-icon">ü§ñ</span>
                                    <div class="option-content">
                                        <h4>An√°lise Completa da IA</h4>
                                        <p>Combina an√°lise estat√≠stica avan√ßada com suas prefer√™ncias</p>
                                        <small style="color: var(--accent-primary); font-weight: 600;">‚ú® Recomendado para todos os usu√°rios</small>
                                    </div>
                                </div>
                            </label>
                        </div>
                    </div>

                    <!-- Op√ß√µes Avan√ßadas -->
                    <div class="form-section">
                        <h3>
                            <span>üîß</span>
                            Op√ß√µes Avan√ßadas
                        </h3>
                        <div class="advanced-options">
                            <div class="checkbox-option">
                                <input type="checkbox" name="avoidPatterns" id="avoidPatterns">
                                <label for="avoidPatterns">Evitar padr√µes √≥bvios (sequ√™ncias, m√∫ltiplos)</label>
                            </div>
                        </div>
                        
                        <div class="numbers-input">
                            <label for="favoriteNumbers">N√∫meros da sorte (opcional)</label>
                            <input 
                                type="text" 
                                name="favoriteNumbers" 
                                id="favoriteNumbers"
                                placeholder="Ex: 7, 13, 25, 42"
                            >
                        </div>
                        
                        <div class="numbers-input">
                            <label for="excludeNumbers">N√∫meros a evitar (opcional)</label>
                            <input 
                                type="text" 
                                name="excludeNumbers" 
                                id="excludeNumbers"
                                placeholder="Ex: 4, 13, 24"
                            >
                        </div>
                    </div>

                    <div class="form-actions">
                        <button type="button" class="btn-secondary" onclick="renderWelcome()">
                            <span class="btn-icon">‚Üê</span>
                            Cancelar
                        </button>
                        <button type="submit" class="btn-primary">
                            <span class="btn-icon">üöÄ</span>
                            Gerar Estrat√©gia
                        </button>
                    </div>
                </form>
            </div>
        </div>
    `;
}

// Definir or√ßamento
function setBudget(amount: number) {
    const budgetInput = document.querySelector('input[name="budget"]') as HTMLInputElement;
    budgetInput.value = amount.toString();
}

// Manipular envio das prefer√™ncias
async function handlePreferencesSubmit(event: Event) {
    event.preventDefault();
    
    const form = event.target as HTMLFormElement;
    
    // Coletar tipos de loteria
    const lotteryTypes = Array.from(form.querySelectorAll('input[name="lotteryType"]:checked'))
        .map(el => (el as HTMLInputElement).value);
    
    if (lotteryTypes.length === 0) {
        alert('Selecione pelo menos uma loteria!');
        return;
    }
    
    // Processar n√∫meros
    const favoriteNumbers = processNumbersInput(form.favoriteNumbers.value);
    const excludeNumbers = processNumbersInput(form.excludeNumbers.value);
    
    // Montar prefer√™ncias
    userPreferences = {
        lotteryTypes,
        budget: parseFloat(form.budget.value),
        strategy: form.strategy.value,
        avoidPatterns: form.avoidPatterns.checked,
        favoriteNumbers,
        excludeNumbers
    };
    
    // Gerar estrat√©gia
    await generateStrategy();
}

// Processar entrada de n√∫meros
function processNumbersInput(input: string): number[] {
    if (!input.trim()) return [];
    
    return input.split(',')
        .map(n => parseInt(n.trim()))
        .filter(n => !isNaN(n) && n > 0);
}

// Gerar estrat√©gia
async function generateStrategy() {
    renderGeneratingScreen();
    
    try {
        // Etapa 1: Coletando dados hist√≥ricos
        updateLoadingStep(0, "Coletando dados hist√≥ricos...");
        await new Promise(resolve => setTimeout(resolve, 800));
        
        // Etapa 2: Analisando padr√µes
        updateLoadingStep(1, "Analisando padr√µes com IA...");
        await new Promise(resolve => setTimeout(resolve, 500));
        
        // Etapa 3: Gerando estrat√©gia (chamada real do backend)
        updateLoadingStep(2, "Calculando probabilidades...");
        
        const response: StrategyResponse = await GenerateStrategy(userPreferences);
        
        // Debug: verificar resposta do backend
        console.log('üîç Response from backend:', response);
        console.log('üîç Success:', response.success);
        console.log('üîç Strategy exists:', !!response.strategy);
        if (response.strategy) {
            console.log('üîç Games:', response.strategy.games);
        }
        if (response.error) {
            console.log('üîç Error:', response.error);
        }
        
        // Etapa 4: Otimizando combina√ß√µes
        updateLoadingStep(3, "Otimizando combina√ß√µes...");
        await new Promise(resolve => setTimeout(resolve, 500));
        
        // Etapa 5: Finalizando
        updateLoadingStep(4, "Finalizando estrat√©gia...");
        await new Promise(resolve => setTimeout(resolve, 500));
        
        if (response.success) {
            renderStrategyResult(response);
        } else {
            renderError(response.error || 'Erro desconhecido');
        }
    } catch (error) {
        console.error('Erro ao gerar estrat√©gia:', error);
        renderError('Erro na an√°lise da IA: ' + error);
    }
}

// Atualizar etapa do loading
function updateLoadingStep(stepIndex: number, message: string) {
    const steps = document.querySelectorAll('.loading-step');
    
    // Remover active de todas as etapas
    steps.forEach(step => step.classList.remove('active'));
    
    // Ativar etapa atual
    if (steps[stepIndex]) {
        steps[stepIndex].classList.add('active');
        steps[stepIndex].textContent = message;
    }
}

// ===============================
// TELA DE GERA√á√ÉO
// ===============================

function renderGeneratingScreen() {
    const app = document.getElementById('app')!;
    app.innerHTML = `
        <div class="loading-screen">
            <div class="loading-content">
                <div class="loading-spinner">ü§ñ</div>
                <h2>Gerando Estrat√©gia Inteligente</h2>
                <div class="loading-steps">
                    <div class="loading-step active">Preparando an√°lise...</div>
                    <div class="loading-step">Analisando padr√µes com IA...</div>
                    <div class="loading-step">Calculando probabilidades...</div>
                    <div class="loading-step">Otimizando combina√ß√µes...</div>
                    <div class="loading-step">Finalizando estrat√©gia...</div>
                </div>
            </div>
        </div>
    `;
}

// ===============================
// TELA DE RESULTADOS
// ===============================

function renderStrategyResult(response: StrategyResponse) {
    const strategy = response.strategy!;
    
    // Debug: verificar estrutura da resposta
    console.log('üîç Debug response:', response);
    console.log('üîç Debug strategy:', strategy);
    console.log('üîç Debug games:', strategy.games);
    
    // Valida√ß√£o de seguran√ßa
    if (!strategy) {
        console.error('‚ùå Strategy is null');
        renderError('Erro: Estrat√©gia n√£o foi gerada corretamente');
        return;
    }
    
    if (!strategy.games || !Array.isArray(strategy.games)) {
        console.error('‚ùå Games is null or not array:', strategy.games);
        renderError('Erro: Jogos n√£o foram gerados corretamente');
        return;
    }
    
    if (strategy.games.length === 0) {
        console.error('‚ùå No games generated');
        renderError('Erro: Nenhum jogo foi gerado');
        return;
    }
    
    // Salvar estrat√©gia globalmente para impress√£o
    (window as any).currentStrategy = strategy;
    
    const app = document.getElementById('app')!;
    app.innerHTML = `
        <div class="container">
            <header class="header">
                <div class="header-content">
                    <h1 class="logo">üé∞ Lottery Optimizer</h1>
                    <p class="tagline">Estrat√©gia Gerada</p>
                </div>
                <button class="btn-back" onclick="renderWelcome()">
                    <span class="btn-icon">üè†</span>
                    In√≠cio
                </button>
            </header>
            
            <div class="strategy-content">
                <div class="wizard-steps">
                    <div class="step">1. Prefer√™ncias</div>
                    <div class="step">2. Estrat√©gia</div>
                    <div class="step active">3. Resultados ‚ú®</div>
                </div>

                <!-- Resumo da Estrat√©gia -->
                <div class="strategy-summary">
                    <div class="summary-item">
                        <span class="label">Or√ßamento</span>
                        <span class="value">R$ ${strategy.budget.toFixed(2)}</span>
                    </div>
                    <div class="summary-item">
                        <span class="label">Custo Total</span>
                        <span class="value">R$ ${strategy.totalCost.toFixed(2)}</span>
                    </div>
                    <div class="summary-item">
                        <span class="label">Jogos</span>
                        <span class="value">${strategy.games.length}</span>
                    </div>
                    <div class="summary-item">
                        <span class="label">Confian√ßa IA</span>
                        <span class="value">${((response.confidence || 0) * 100).toFixed(1)}%</span>
                    </div>
                </div>

                <!-- Jogos Gerados -->
                <div class="games-section">
                    <h3>
                        <span>üé≤</span>
                        Seus Jogos Inteligentes
                    </h3>
                    <div class="games-grid">
                        ${strategy.games.map((game: LotteryGame, index: number) => `
                            <div class="game-card">
                                <div class="game-header">
                                    <span class="game-icon">${game.type === 'megasena' ? 'üî•' : '‚≠ê'}</span>
                                    <span class="game-title">${game.type === 'megasena' ? 'Mega-Sena' : 'Lotof√°cil'} #${index + 1}</span>
                                    <span class="game-cost">R$ ${game.cost.toFixed(2)}</span>
                                </div>
                                <div class="game-numbers">
                                    ${game.numbers.map((num: number) => `<span class="number">${num.toString().padStart(2, '0')}</span>`).join('')}
                                </div>
                            </div>
                        `).join('')}
                    </div>
                </div>

                <!-- Racioc√≠nio da IA -->
                <div class="form-section">
                    <h3>
                        <span>üß†</span>
                        Racioc√≠nio da Intelig√™ncia Artificial
                    </h3>
                    <div style="background: var(--bg-tertiary); padding: var(--spacing-6); border-radius: var(--border-radius); border: 1px solid var(--border-color); line-height: 1.7; color: var(--text-secondary);">
                        ${strategy.reasoning.replace(/\n/g, '<br>')}
                    </div>
                </div>

                <!-- Estat√≠sticas -->
                <div class="form-section">
                    <h3>
                        <span>üìä</span>
                        Estat√≠sticas da An√°lise
                    </h3>
                    <div class="stats-grid">
                        <div class="stat-card">
                            <div class="stat-icon">üìà</div>
                            <div class="stat-content">
                                <span class="label">Sorteios Analisados</span>
                                <span class="value">${strategy.statistics.analyzedDraws}</span>
                            </div>
                        </div>
                        
                        <div class="stat-card">
                            <div class="stat-icon">üî•</div>
                            <div class="stat-content">
                                <span class="label">N√∫meros Quentes</span>
                                <div style="display: flex; gap: var(--spacing-1); flex-wrap: wrap; margin-top: var(--spacing-2);">
                                    ${(strategy.statistics.hotNumbers && Array.isArray(strategy.statistics.hotNumbers)) 
                                        ? strategy.statistics.hotNumbers.slice(0, 10).map(num => 
                                            `<span style="background: var(--accent-success); color: white; padding: var(--spacing-1) var(--spacing-2); border-radius: 4px; font-size: var(--font-size-sm); font-weight: 600;">${num}</span>`
                                        ).join('')
                                        : '<span style="color: var(--text-secondary);">Dados n√£o dispon√≠veis</span>'
                                    }
                                </div>
                            </div>
                        </div>
                        
                        <div class="stat-card">
                            <div class="stat-icon">‚ùÑÔ∏è</div>
                            <div class="stat-content">
                                <span class="label">N√∫meros Frios</span>
                                <div style="display: flex; gap: var(--spacing-1); flex-wrap: wrap; margin-top: var(--spacing-2);">
                                    ${(strategy.statistics.coldNumbers && Array.isArray(strategy.statistics.coldNumbers))
                                        ? strategy.statistics.coldNumbers.slice(0, 10).map(num => 
                                            `<span style="background: var(--accent-info); color: white; padding: var(--spacing-1) var(--spacing-2); border-radius: 4px; font-size: var(--font-size-sm); font-weight: 600;">${num}</span>`
                                        ).join('')
                                        : '<span style="color: var(--text-secondary);">Dados n√£o dispon√≠veis</span>'
                                    }
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Avisos e Alertas -->
                ${(response.failedLotteries && response.failedLotteries.length > 0) ? `
                    <div style="background: rgba(245, 158, 11, 0.1); border: 1px solid var(--accent-warning); border-radius: var(--border-radius); padding: var(--spacing-4); margin: var(--spacing-6) 0; color: var(--accent-warning);">
                        ‚ö†Ô∏è <strong>Aviso:</strong> Algumas loterias n√£o estavam dispon√≠veis: ${response.failedLotteries.join(', ')}. 
                        A estrat√©gia foi gerada apenas para: ${response.availableLotteries?.join(', ')}.
                    </div>
                ` : ''}

                <!-- A√ß√µes -->
                <div class="form-actions">
                    <button class="btn-secondary" onclick="renderPreferencesForm()">
                        <span class="btn-icon">üîÑ</span>
                        Nova Estrat√©gia
                    </button>
                    <button class="btn-primary" onclick="printStrategy()">
                        <span class="btn-icon">üñ®Ô∏è</span>
                        Imprimir Jogos
                    </button>
                </div>
            </div>
        </div>
    `;
}

// Imprimir estrat√©gia
function printStrategy() {
    // Buscar os dados da estrat√©gia atual
    const strategy = (window as any).currentStrategy;
    if (!strategy) {
        alert('Nenhuma estrat√©gia dispon√≠vel para impress√£o');
        return;
    }
    
    // Criar janela de impress√£o apenas com os jogos
    const printWindow = window.open('', '_blank');
    if (!printWindow) {
        alert('Bloqueador de pop-up ativo. Permita pop-ups para imprimir.');
        return;
    }
    
    const printContent = `
        <!DOCTYPE html>
        <html>
        <head>
            <title>Jogos da Loteria - Lottery Optimizer</title>
            <style>
                body {
                    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
                    margin: 0;
                    padding: 20px;
                    color: #333;
                    background: white;
                }
                .header {
                    text-align: center;
                    margin-bottom: 30px;
                    border-bottom: 3px solid #6366f1;
                    padding-bottom: 20px;
                }
                .header h1 {
                    margin: 0 0 10px 0;
                    color: #1e293b;
                    font-size: 28px;
                }
                .header p {
                    margin: 5px 0;
                    color: #64748b;
                    font-size: 14px;
                }
                .summary {
                    display: grid;
                    grid-template-columns: repeat(4, 1fr);
                    gap: 15px;
                    margin-bottom: 30px;
                    padding: 20px;
                    background: #f8fafc;
                    border-radius: 12px;
                    border: 2px solid #e2e8f0;
                }
                .summary-item {
                    text-align: center;
                    padding: 10px;
                }
                .summary-label {
                    font-size: 12px;
                    color: #64748b;
                    margin-bottom: 8px;
                    text-transform: uppercase;
                    font-weight: 600;
                    letter-spacing: 0.5px;
                }
                .summary-value {
                    font-size: 24px;
                    font-weight: bold;
                    color: #1e293b;
                }
                .games-grid {
                    display: grid;
                    grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
                    gap: 20px;
                    margin-bottom: 30px;
                }
                .game-card {
                    border: 2px solid #e2e8f0;
                    border-radius: 12px;
                    padding: 20px;
                    background: white;
                    box-shadow: 0 1px 3px rgba(0,0,0,0.1);
                }
                .game-header {
                    display: flex;
                    justify-content: space-between;
                    align-items: center;
                    margin-bottom: 15px;
                    padding-bottom: 10px;
                    border-bottom: 1px solid #e2e8f0;
                }
                .game-title {
                    font-size: 18px;
                    font-weight: bold;
                    color: #1e293b;
                }
                .game-cost {
                    color: #059669;
                    font-size: 16px;
                    font-weight: bold;
                    background: #ecfdf5;
                    padding: 4px 8px;
                    border-radius: 6px;
                }
                .game-numbers {
                    display: flex;
                    flex-wrap: wrap;
                    gap: 8px;
                    justify-content: center;
                }
                .number {
                    background: #6366f1;
                    color: white;
                    padding: 10px 12px;
                    border-radius: 50%;
                    font-weight: bold;
                    font-size: 16px;
                    min-width: 24px;
                    text-align: center;
                    box-shadow: 0 2px 4px rgba(99, 102, 241, 0.3);
                }
                .footer {
                    margin-top: 40px;
                    text-align: center;
                    color: #64748b;
                    font-size: 12px;
                    border-top: 1px solid #e2e8f0;
                    padding-top: 20px;
                }
                .footer p {
                    margin: 5px 0;
                }
                .disclaimer {
                    background: #fef3c7;
                    border: 1px solid #f59e0b;
                    border-radius: 8px;
                    padding: 15px;
                    margin: 20px 0;
                    text-align: center;
                }
                @media print {
                    body { 
                        margin: 0; 
                        padding: 15px;
                        font-size: 14px;
                    }
                    .header { 
                        page-break-after: avoid; 
                        margin-bottom: 20px;
                    }
                    .game-card { 
                        page-break-inside: avoid; 
                        margin-bottom: 15px;
                    }
                    .summary {
                        margin-bottom: 20px;
                    }
                }
            </style>
        </head>
        <body>
            <div class="header">
                <h1>üé∞ Seus Jogos Inteligentes</h1>
                <p>Gerado por <strong>Lottery Optimizer</strong> com Claude AI</p>
                <p><strong>Data de Gera√ß√£o:</strong> ${new Date().toLocaleDateString('pt-BR')} √†s ${new Date().toLocaleTimeString('pt-BR')}</p>
            </div>
            
            <div class="summary">
                <div class="summary-item">
                    <div class="summary-label">Or√ßamento</div>
                    <div class="summary-value">R$ ${strategy.budget.toFixed(2)}</div>
                </div>
                <div class="summary-item">
                    <div class="summary-label">Custo Total</div>
                    <div class="summary-value">R$ ${strategy.totalCost.toFixed(2)}</div>
                </div>
                <div class="summary-item">
                    <div class="summary-label">Total de Jogos</div>
                    <div class="summary-value">${strategy.games.length}</div>
                </div>
                <div class="summary-item">
                    <div class="summary-label">Economia</div>
                    <div class="summary-value">R$ ${(strategy.budget - strategy.totalCost).toFixed(2)}</div>
                </div>
            </div>
            
            <div class="games-grid">
                ${strategy.games.map((game: LotteryGame, index: number) => `
                    <div class="game-card">
                        <div class="game-header">
                            <span class="game-title">${game.type === 'megasena' ? 'üî• Mega-Sena' : '‚≠ê Lotof√°cil'} #${index + 1}</span>
                            <span class="game-cost">R$ ${game.cost.toFixed(2)}</span>
                        </div>
                        <div class="game-numbers">
                            ${game.numbers.map((num: number) => `<span class="number">${num.toString().padStart(2, '0')}</span>`).join('')}
                        </div>
                    </div>
                `).join('')}
            </div>
            
            <div class="disclaimer">
                <p><strong>‚ö†Ô∏è IMPORTANTE:</strong> A loteria √© um jogo de azar. Jogue com responsabilidade e apenas o que pode perder.</p>
            </div>
            
            <div class="footer">
                <p><strong>Estrat√©gia gerada com base em an√°lise estat√≠stica de dados hist√≥ricos</strong></p>
                <p>Esta estrat√©gia foi criada usando intelig√™ncia artificial que analisou ${strategy.statistics?.analyzedDraws || 100} sorteios hist√≥ricos</p>
                <p>N√∫meros podem ser marcados em qualquer lot√©rica ou site oficial da CAIXA</p>
                <p style="margin-top: 15px; font-size: 10px;">Lottery Optimizer ¬© 2025 - Powered by Claude AI</p>
            </div>
        </body>
        </html>
    `;
    
    printWindow.document.write(printContent);
    printWindow.document.close();
    
    // Aguardar carregamento e imprimir
    printWindow.onload = () => {
        setTimeout(() => {
            printWindow.print();
            printWindow.close();
        }, 500);
    };
}

// ===============================
// TELA DE ERRO
// ===============================

function renderError(message: string) {
    const app = document.getElementById('app')!;
    app.innerHTML = `
        <div class="error-screen">
            <div class="error-content">
                <div class="error-icon">‚ùå</div>
                <h2>Oops! Algo deu errado</h2>
                <div class="error-message">${message}</div>
                
                <div class="error-actions">
                    <button class="btn-secondary" onclick="renderWelcome()">
                        <span class="btn-icon">üè†</span>
                        Voltar ao In√≠cio
                    </button>
                    <button class="btn-primary" onclick="renderPreferencesForm()">
                        <span class="btn-icon">üîÑ</span>
                        Tentar Novamente
                    </button>
                </div>
      </div>
    </div>
`;
}

// ===============================
// FUN√á√ïES GLOBAIS
// ===============================

// Disponibilizar fun√ß√µes globalmente
(window as any).renderWelcome = renderWelcome;
(window as any).renderConfigurationScreen = renderConfigurationScreen;
(window as any).renderPreferencesForm = renderPreferencesForm;
(window as any).startStrategyWizard = startStrategyWizard;
(window as any).setBudget = setBudget;
(window as any).handlePreferencesSubmit = handlePreferencesSubmit;
(window as any).handleConfigSave = handleConfigSave;
(window as any).testConnections = testConnections;
(window as any).loadDefaultConfig = loadDefaultConfig;
(window as any).checkConfigAndRender = checkConfigAndRender;
(window as any).printStrategy = printStrategy;

// Fun√ß√£o de debug espec√≠fica para Claude
async function debugClaudeConfig() {
    console.log('üîç [DEBUG] Testando configura√ß√£o do Claude...');
    
    try {
        const debugInfo = await DebugClaudeConfig();
        console.log('üîç [DEBUG] Informa√ß√µes do Claude:', debugInfo);
        
        // Mostrar info detalhada no console
        console.table(debugInfo);
        
        // Mostrar alerta com informa√ß√µes principais
        const summary = `
üîç DEBUG CLAUDE CONFIG:
‚Ä¢ Has API Key: ${debugInfo.hasApiKey}
‚Ä¢ API Key Length: ${debugInfo.apiKeyLength}
‚Ä¢ API Key Preview: ${debugInfo.apiKeyPreview}
‚Ä¢ API Key Valid Format: ${debugInfo.apiKeyLooksValid}
‚Ä¢ Connection Test: ${debugInfo.connectionTest}
‚Ä¢ Config Path: ${debugInfo.configPath}
‚Ä¢ Config Exists: ${debugInfo.configExists}
‚Ä¢ Claude Model: ${debugInfo.claudeModel}
‚Ä¢ Max Tokens: ${debugInfo.maxTokens}
‚Ä¢ Timeout: ${debugInfo.timeout}
‚Ä¢ Verbose: ${debugInfo.verbose}
`;
        
        alert(summary);
        
        return debugInfo;
        
    } catch (error) {
        console.error('‚ùå [DEBUG] Erro ao testar Claude:', error);
        alert('‚ùå Erro ao testar configura√ß√£o do Claude: ' + error);
        return null;
    }
}

// Fun√ß√£o para adicionar bot√£o de debug na interface
function addDebugButton() {
    const debugButton = document.createElement('button');
    debugButton.textContent = 'üîç Debug Claude';
    debugButton.style.cssText = `
        position: fixed;
        bottom: 10px;
        right: 10px;
        z-index: 9999;
        background: #007bff;
        color: white;
        border: none;
        padding: 8px 12px;
        border-radius: 4px;
        cursor: pointer;
        font-size: 12px;
    `;
    debugButton.onclick = debugClaudeConfig;
    document.body.appendChild(debugButton);
}
